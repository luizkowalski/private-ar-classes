<div data-controller="comment">
  <div class="box">
    <article class="media">
      <div class="media-content">
        <div class="content">
          <p>
            <strong><%= link_to("r/#{post.community}",  subreddit_path(post.community)) %></strong>
            <br>
            <strong>
              <%= post.title %>
            </strong><small> by u/<%=post.username %> </small>
            <small><%= time_ago_in_words(post.created_at) %> ago</small>
            <br>
            <%= post.body %>
          </p>
          <div class="media-content" data-controller="vote">
            <button class="button is-link is-small is-rounded" 
            data-action="click->vote#upvote"
              data-vote-post-id-param=<%=post.id%>
              data-vote-url-param=<%= subreddit_post_votes_path(subreddit_id: post.community, post_id: post.id)%>
              data-vote-method-param="post"
              data-vote-token-param=<%= form_authenticity_token %>>
              <span>👍🏻</span>
              <span data-vote-target="upvotes">&nbsp;<%= post.votes %></span>
            </button>
          </div>
        </div>
        <footer class="card-footer">
          <div class="media-content">
            <div class="control mt-4">
              <%= text_area_tag(:body, '', class: 'textarea is-info is-full-width', required: "required", data: { comment_target: 'body'}) %>
              <button class="button is-link mt-4 is-small is-rounded" 
                data-action="click->comment#comment"
                data-comment-post-id-param=<%=post.id%>
                data-comment-url-param=<%= subreddit_post_comments_path(subreddit_id: post.community, post_id: post.id)%>
                data-comment-method-param="post"
                data-comment-token-param=<%= form_authenticity_token %>>
                <span>Send</span>
              </button>
            </div>
          </div>
        </footer>
      </div>
    </article>
  </div>
  <ul data-comment-target="comments">
    <% comments.each do |comment|%>
      <%= render Subreddits::CommentComponent.new(comment: comment) %>
    <% end %>
  </ul>
</div>
